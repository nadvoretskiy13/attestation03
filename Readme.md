## Сборка и запуск в докере

Конфигурация описана в [docker-compose.yaml](docker-compose.yaml).
В ней используются переменные следующие окружения:
- PG_USER - пользователь БД.
- PG_PASSWORD - пароль для пользователя БД.
- PG_PORT - порт сервера БД, на котором она будет принимать соединения (в контейнере).
- SERVER_PORT - порт веб приложения, на котором оно будет принимать соединения (в контейнере).

Переменные окружения могут быть заданы различными способами: из опций, непосредственно из окружения
или из специальных файлов или хранилищ. Одним из простых способов является задание переменных окружения в файле [.env](.env).
Докер сам читает данный файл (при наличии).

Эти переменные будет использоваться как при первоначальной настройке контейнера самой бд, так и приложениями для подключения к ней.
Значения в предоставленном файле - пример. Если нужно, укажите свои значения.

Переменные окружения относятся к чувствительной информации, поэтому их не следует помещать в СКВ и прочие общедоступные места.
В случае с git, файл [.env](.env) добавляется в [.gitignore](.gitignore).

Запускать можно как все сервисы вместе (бд + приложение), так и по отдельности, учитывая, что приложение без бд
не работает. Например, можно запустить только бд, или если бд уже работает, можно запустить только приложение.
Также и с остановкой сервисов - все разом или по отдельности.

Сборка образа приложения описана в файле [Dockerfile](Dockerfile). Сборка идет полностью в докере из исходников проекта.

Самым простым способом запуска всех сервисов является переход в папку с проектом
(там где [docker-compose.yaml](docker-compose.yaml)) и запуск в ней команды:
```
docker compose -p hospital up -d --build reception-app
```
Опция `--build` нужна для сборки образа нашего приложения `reception-app`.
`-p` указывает имя проекта (выбирайте любое... или не выбирайте/указывайте).
`-d` означает `detached` от консоли (выполнение на заднем фоне).

Для остановки всех контейнеров выполняется команда:
```
docker compose stop
```
Последующий запуск выполняется командой:
```
docker compose start
```
Запустить или остановить сервис(ы) по отдельности можно указав в команде имя сервиса(ов). Например:
```
# запускает только hospital-db
docker compose start hospital-db

# останавливает только reception-app
docker compose stop reception-app
```
Остановить контейнеры с последующим их удалением можно командой (образы остаются):
```
docker compose down
```
Чтобы, после последней команды, запустить все контейнеры снова, нужно будет выполнить:
```
docker compose up -d
```
Также `compose up` требуется выполнить, если был изменен [docker-compose.yaml](docker-compose.yaml),
а при изменении кода приложения, нужно будет также пересобрать его образ (опция `--build`)

## Работа приложения
По умолчанию (с заданной конфигурацией и при локальном запуске) приложение доступно по адресу [http://localhost:8080](http://localhost:8080).
Для работы в приложении требуется авторизация.
Зарегистрировать нового пользователя можно по адресу [http://localhost:8080/register](http://localhost:8080/register).
После успешной регистрации, заданные логин и пароль могут использоваться при доступе ко всем ресурсам приложения,
требующих авторизации: веб интерфейс или вызов API.

Эндпоинты API с их описанием можно увидеть с помощью swagger интерфейса [http://localhost:8080/swagger-ui.html](http://localhost:8080/swagger-ui.html).
Для доступа к странице, авторизация не требуется, но для выполнения вызовов API требуется указать ранее зарегистрированные логин и пароль.
Тип способа авторизации - basic. При доступе к API через Postman (или другие), требуется указать именно этот способ авторизации при указании логина и пароля.